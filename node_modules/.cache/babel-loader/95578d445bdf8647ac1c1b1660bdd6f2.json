{"ast":null,"code":"// Copyright 2021 The Go Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style\n// license that can be found in the LICENSE file.\n\"use strict\";\n\nglobalThis.require = require;\nglobalThis.fs = require(\"fs\");\nglobalThis.TextEncoder = require(\"util\").TextEncoder;\nglobalThis.TextDecoder = require(\"util\").TextDecoder;\nglobalThis.performance = {\n  now() {\n    const [sec, nsec] = process.hrtime();\n    return sec * 1000 + nsec / 1000000;\n  }\n\n};\n\nconst crypto = require(\"./crypto\");\n\nglobalThis.crypto = {\n  getRandomValues(b) {\n    crypto.randomFillSync(b);\n  }\n\n};\n\nrequire(\"./wasm_exec\");\n\nconst go = new Go();\ngo.argv = process.argv.slice(2);\ngo.env = Object.assign({\n  TMPDIR: require(\"os\").tmpdir()\n}, process.env);\ngo.exit = process.exit;\nWebAssembly.instantiate(fs.readFileSync(process.argv[2]), go.importObject).then(result => {\n  process.on(\"exit\", code => {\n    // Node.js exits if no event handler is pending\n    if (code === 0 && !go.exited) {\n      // deadlock, make Go print error and stack traces\n      go._pendingEvent = {\n        id: 0\n      };\n\n      go._resume();\n    }\n  });\n  return go.run(result.instance);\n}).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","map":{"version":3,"names":["globalThis","require","fs","TextEncoder","TextDecoder","performance","now","sec","nsec","process","hrtime","crypto","getRandomValues","b","randomFillSync","go","Go","argv","slice","env","Object","assign","TMPDIR","tmpdir","exit","WebAssembly","instantiate","readFileSync","importObject","then","result","on","code","exited","_pendingEvent","id","_resume","run","instance","catch","err","console","error"],"sources":["/home/johan/dev/github/colonyos/dashboard/dashboard/src/colonies/crypto/wasm_exec_node.js"],"sourcesContent":["// Copyright 2021 The Go Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style\n// license that can be found in the LICENSE file.\n\n\"use strict\";\n\nglobalThis.require = require;\nglobalThis.fs = require(\"fs\");\nglobalThis.TextEncoder = require(\"util\").TextEncoder;\nglobalThis.TextDecoder = require(\"util\").TextDecoder;\n\nglobalThis.performance = {\n    now() {\n        const [sec, nsec] = process.hrtime();\n        return sec * 1000 + nsec / 1000000;\n    },\n};\n\nconst crypto = require(\"./crypto\");\nglobalThis.crypto = {\n    getRandomValues(b) {\n        crypto.randomFillSync(b);\n    },\n};\n\nrequire(\"./wasm_exec\");\n\nconst go = new Go();\ngo.argv = process.argv.slice(2);\ngo.env = Object.assign({ TMPDIR: require(\"os\").tmpdir() }, process.env);\ngo.exit = process.exit;\nWebAssembly.instantiate(fs.readFileSync(process.argv[2]), go.importObject).then((result) => {\n    process.on(\"exit\", (code) => { // Node.js exits if no event handler is pending\n        if (code === 0 && !go.exited) {\n            // deadlock, make Go print error and stack traces\n            go._pendingEvent = { id: 0 };\n            go._resume();\n        }\n    });\n    return go.run(result.instance);\n}).catch((err) => {\n    console.error(err);\n    process.exit(1);\n});\n"],"mappings":"AAAA;AACA;AACA;AAEA;;AAEAA,UAAU,CAACC,OAAX,GAAqBA,OAArB;AACAD,UAAU,CAACE,EAAX,GAAgBD,OAAO,CAAC,IAAD,CAAvB;AACAD,UAAU,CAACG,WAAX,GAAyBF,OAAO,CAAC,MAAD,CAAP,CAAgBE,WAAzC;AACAH,UAAU,CAACI,WAAX,GAAyBH,OAAO,CAAC,MAAD,CAAP,CAAgBG,WAAzC;AAEAJ,UAAU,CAACK,WAAX,GAAyB;EACrBC,GAAG,GAAG;IACF,MAAM,CAACC,GAAD,EAAMC,IAAN,IAAcC,OAAO,CAACC,MAAR,EAApB;IACA,OAAOH,GAAG,GAAG,IAAN,GAAaC,IAAI,GAAG,OAA3B;EACH;;AAJoB,CAAzB;;AAOA,MAAMG,MAAM,GAAGV,OAAO,CAAC,UAAD,CAAtB;;AACAD,UAAU,CAACW,MAAX,GAAoB;EAChBC,eAAe,CAACC,CAAD,EAAI;IACfF,MAAM,CAACG,cAAP,CAAsBD,CAAtB;EACH;;AAHe,CAApB;;AAMAZ,OAAO,CAAC,aAAD,CAAP;;AAEA,MAAMc,EAAE,GAAG,IAAIC,EAAJ,EAAX;AACAD,EAAE,CAACE,IAAH,GAAUR,OAAO,CAACQ,IAAR,CAAaC,KAAb,CAAmB,CAAnB,CAAV;AACAH,EAAE,CAACI,GAAH,GAASC,MAAM,CAACC,MAAP,CAAc;EAAEC,MAAM,EAAErB,OAAO,CAAC,IAAD,CAAP,CAAcsB,MAAd;AAAV,CAAd,EAAkDd,OAAO,CAACU,GAA1D,CAAT;AACAJ,EAAE,CAACS,IAAH,GAAUf,OAAO,CAACe,IAAlB;AACAC,WAAW,CAACC,WAAZ,CAAwBxB,EAAE,CAACyB,YAAH,CAAgBlB,OAAO,CAACQ,IAAR,CAAa,CAAb,CAAhB,CAAxB,EAA0DF,EAAE,CAACa,YAA7D,EAA2EC,IAA3E,CAAiFC,MAAD,IAAY;EACxFrB,OAAO,CAACsB,EAAR,CAAW,MAAX,EAAoBC,IAAD,IAAU;IAAE;IAC3B,IAAIA,IAAI,KAAK,CAAT,IAAc,CAACjB,EAAE,CAACkB,MAAtB,EAA8B;MAC1B;MACAlB,EAAE,CAACmB,aAAH,GAAmB;QAAEC,EAAE,EAAE;MAAN,CAAnB;;MACApB,EAAE,CAACqB,OAAH;IACH;EACJ,CAND;EAOA,OAAOrB,EAAE,CAACsB,GAAH,CAAOP,MAAM,CAACQ,QAAd,CAAP;AACH,CATD,EASGC,KATH,CASUC,GAAD,IAAS;EACdC,OAAO,CAACC,KAAR,CAAcF,GAAd;EACA/B,OAAO,CAACe,IAAR,CAAa,CAAb;AACH,CAZD"},"metadata":{},"sourceType":"module"}